{"version":3,"sources":["../src/Vee/Elements/Core/ViewInflater.ts"],"names":[],"mappings":"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","file":"ViewInflater.js","sourcesContent":["import Loader from \"Vee/Elements/Core/Loader\";\r\n\r\ntype InflationChain = (parent: HTMLElement, value: any, obj: any, map: { [id: string]: any },\r\n\tmountingPoints: HTMLElement[]) => any;\r\n\r\nexport default class ViewInflater {\r\n\tprivate static readonly INSTANCE_KEY = \"instance\";\r\n\t\r\n\tpublic static async inflate(parent: HTMLElement, elements: any[], map: { [id: string]: any },\r\n\t\tmountingPoints: HTMLElement[]): Promise<any[]> {\r\n\t\tvar result = [];\r\n\t\tfor (var i = 0; i < elements.length; i++) {\r\n\t\t\tvar element = elements[i];\r\n\t\t\tif (element.hasOwnProperty(ViewInflater.INSTANCE_KEY)) {\r\n\t\t\t\t// Create instance.\r\n\t\t\t\tvar instanceTypePath = element[ViewInflater.INSTANCE_KEY];\r\n\t\t\t\tvar instanceType = await ViewInflater.createInstance(instanceTypePath);\r\n\t\t\t\tvar instance = new instanceType(parent);\r\n\t\t\t\tif (ViewInflater.isContainer(instance)) {\r\n\t\t\t\t\tmountingPoints.push.apply(mountingPoints, instance.getScreenMountingPoints());\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//  Apply and transform properties.\r\n\t\t\t\tfor (var key in element) {\r\n\t\t\t\t\tif (key === ViewInflater.INSTANCE_KEY) continue;\r\n\r\n\t\t\t\t\tvar property = element[key];\r\n\r\n\t\t\t\t\tif (!(key in instance)) console.warn(\"No property called \" + key);\r\n\r\n\t\t\t\t\tif (ViewInflater.isContainer(instance) && ViewInflater.isObjectDefinition(property)) {\r\n\t\t\t\t\t\t// Find the parent for the new elements.\r\n\t\t\t\t\t\tvar containerElement = instance.getComponentContainerElement(key);\r\n\t\t\t\t\t\tif (containerElement !== undefined) {\r\n\t\t\t\t\t\t\t// Inflate the elements.\r\n\t\t\t\t\t\t\tinstance[key] = await ViewInflater.inflationChain(containerElement, property, map,\r\n\t\t\t\t\t\t\t\tmountingPoints);\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tinstance[key] = property;\r\n\t\t\t\t}\r\n\t\t\t\tinstance.onShow();\r\n\t\t\t\t// Add to map.\r\n\t\t\t\tif (instance.id !== undefined) {\r\n\t\t\t\t\tmap[instance.id] = instance;\r\n\t\t\t\t}\r\n\t\t\t\t// Add to inflation results.\r\n\t\t\t\tresult.push(instance);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic static async InflateByPath(path: string, parent: HTMLElement, obj: any): Promise<any> {\r\n\t\tvar instanceType = await ViewInflater.createInstance(path);\r\n\t\tvar instance = new instanceType(parent);\r\n\t\tfor (var key in obj) {\r\n\t\t\tvar property = obj[key];\r\n\r\n\t\t\tinstance[key] = property;\r\n\t\t}\r\n\t\tinstance.onShow();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tprivate static async createInstance(path: string): Promise<{ new(parent: HTMLElement): any }> {\r\n\t\tvar module = await Loader.sync([path]);\r\n\t\t// Return the default class.\r\n\t\treturn module.default;\r\n\t}\r\n\r\n\tprivate static isContainer(obj: any): boolean {\r\n\t\treturn (\"getComponentContainerElement\" in obj && \"getScreenMountingPoints\" in obj);\r\n\t}\r\n\r\n\tprivate static isObjectDefinition(obj: any): boolean {\r\n\t\tif (Array.isArray(obj)) return true;\r\n\t\tif (typeof obj === \"object\") {\r\n\t\t\treturn obj.hasOwnProperty(ViewInflater.INSTANCE_KEY);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate static async inflationChain(parent: HTMLElement, value: any, map: { [id: string]: any },\r\n\t\tmountingPoints: HTMLElement[]): Promise<any[]> {\r\n\t\tif (!Array.isArray(value)) value = [value];\r\n\t\treturn await ViewInflater.inflate(parent, value, map, mountingPoints);\r\n\t}\r\n}"]}